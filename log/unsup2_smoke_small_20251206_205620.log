2025-12-06 20:56:22,490 - INFO - Args: {'scenario': 'unsup2', 'seed': 0, 'batch_size_images': 8, 'event_batch_size': 2048, 'run_name': 'smoke_small_20251206_205620_unsup2', 'log_interval': 1, 'num_epochs': 1, 'T_unsup1': 50, 'T_unsup2': 50, 'T_semi': 50, 'T_sup': 50, 'spike_array_len': 10, 'sigma_unsup1': 0.1, 'sigma_unsup2': 0.1, 'sigma_semi': 0.1, 'sigma_sup': 0.1, 'N_E': 32, 'N_hidden': 64, 'dt': 1.0, 'layer_index_scale': 1.0, 'lr_actor': 0.001, 'lr_critic': 0.001, 'ppo_eps': 0.2, 'ppo_epochs': 2, 'ppo_batch_size': 512, 'exc_clip_min': 0.0, 'exc_clip_max': 1.0, 'inh_clip_min': 0.0, 'inh_clip_max': 1.0, 'local_lr': 0.01, 'rho_target': 0.1, 'alpha_sparse': 1.0, 'alpha_div': 0.1, 'alpha_stab': 0.1, 'beta_margin': 0.5, 'alpha_align': 0.1, 'max_rate': 0.1, 'log_gradient_stats': False, 'result_dir': 'results/unsup2/smoke_small_20251206_205620_unsup2'}
2025-12-06 20:56:22,490 - INFO - Starting scenario: unsup2
2025-12-06 20:56:22,490 - INFO - Results will be saved to: results/unsup2/smoke_small_20251206_205620_unsup2
2025-12-06 20:56:24,593 - INFO - Epoch 1/1 | Batch 1/6750
2025-12-06 20:56:25,837 - INFO - Epoch 1/1 | Batch 2/6750
2025-12-06 20:56:27,276 - INFO - Epoch 1/1 | Batch 3/6750
2025-12-06 20:56:28,641 - INFO - Epoch 1/1 | Batch 4/6750
2025-12-06 20:56:29,875 - INFO - Epoch 1/1 | Batch 5/6750
2025-12-06 20:56:31,048 - INFO - Epoch 1/1 | Batch 6/6750
2025-12-06 20:56:32,537 - INFO - Epoch 1/1 | Batch 7/6750
2025-12-06 20:56:34,116 - INFO - Epoch 1/1 | Batch 8/6750
2025-12-06 20:56:35,390 - INFO - Epoch 1/1 | Batch 9/6750
2025-12-06 20:56:36,356 - INFO - Epoch 1/1 | Batch 10/6750
Traceback (most recent call last):
  File "/home/yongokhan/바탕화면/snn/RL_SNN/main.py", line 39, in <module>
    main()
  File "/home/yongokhan/바탕화면/snn/RL_SNN/main.py", line 35, in main
    runner(args, logger)
  File "/home/yongokhan/바탕화면/snn/RL_SNN/scenarios/unsup_dual.py", line 345, in run_unsup2
    ppo_update_events(
  File "/home/yongokhan/바탕화면/snn/RL_SNN/rl/ppo.py", line 114, in ppo_update_events
    optimizer_actor.zero_grad()
  File "/home/yongokhan/miniconda3/envs/snn/lib/python3.11/site-packages/torch/_compile.py", line 53, in inner
    return disable_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yongokhan/miniconda3/envs/snn/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 929, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/yongokhan/miniconda3/envs/snn/lib/python3.11/site-packages/torch/optim/optimizer.py", line 1027, in zero_grad
    with torch.autograd.profiler.record_function(self._zero_grad_profile_name):
  File "/home/yongokhan/miniconda3/envs/snn/lib/python3.11/site-packages/torch/autograd/profiler.py", line 793, in __exit__
    torch.ops.profiler._record_function_exit._RecordFunction(record)
  File "/home/yongokhan/miniconda3/envs/snn/lib/python3.11/site-packages/torch/_ops.py", line 1057, in __call__
    if _must_dispatch_in_python(args, kwargs):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yongokhan/miniconda3/envs/snn/lib/python3.11/site-packages/torch/_ops.py", line 1117, in _must_dispatch_in_python
    return pytree.tree_any(
           ^^^^^^^^^^^^^^^^
  File "/home/yongokhan/miniconda3/envs/snn/lib/python3.11/site-packages/torch/utils/_pytree.py", line 1651, in tree_any
    return any(map(pred, flat_args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yongokhan/miniconda3/envs/snn/lib/python3.11/site-packages/torch/utils/_pytree.py", line 1311, in tree_iter
    if tree_is_leaf(tree, is_leaf=is_leaf):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yongokhan/miniconda3/envs/snn/lib/python3.11/site-packages/torch/utils/_pytree.py", line 1045, in tree_is_leaf
    return _get_node_type(tree) not in SUPPORTED_NODES
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/yongokhan/miniconda3/envs/snn/lib/python3.11/site-packages/torch/utils/_pytree.py", line 1018, in _get_node_type
    if is_namedtuple_class(node_type):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yongokhan/miniconda3/envs/snn/lib/python3.11/site-packages/torch/utils/_pytree.py", line 679, in is_namedtuple_class
    def is_namedtuple_class(cls: type) -> bool:
    
KeyboardInterrupt
